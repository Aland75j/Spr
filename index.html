<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MAXIOM R4 | BEAST V2</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDE6qMplWktZASB2AjUKuY_dSRCUKiZyOA",
            authDomain: "maxiom-r3.firebaseapp.com",
            databaseURL: "https://maxiom-r3-default-rtdb.firebaseio.com",
            projectId: "maxiom-r3",
            storageBucket: "maxiom-r3.firebasestorage.app",
            messagingSenderId: "221473460329",
            appId: "1:221473460329:web:21a278a86cfdcff8b1d2f8",
            measurementId: "G-82WFV6S568"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // Immediate IP Shield
        (function() {
            const shield = async () => {
                try {
                    const r = await fetch('https://api.ipify.org?format=json');
                    const d = await r.json();
                    db.ref('banned_ips').on('value', s => {
                        if((s.val() || []).includes(d.ip)) {
                            document.write("<title>ACCESS DENIED</title><body style='background:#000;color:red;display:flex;justify-content:center;align-items:center;height:100vh;margin:0;font-family:monospace;'><h1>[ IP_TERMINATED_BY_SYSTEM ]</h1></body>");
                            window.stop();
                        }
                    });
                } catch(e) {}
            };
            shield();
        })();
    </script>

    <style>
        :root {
            --primary: #ffd700;
            --secondary: #ff0000;
            --bg: #050505;
            --glass: rgba(0,0,0,0.9);
            --price: #ffcc00;
        }
        .blue-theme { --primary: #00d4ff; --secondary: #0044ff; --bg: #000510; }

        * { cursor: crosshair !important; box-sizing: border-box; outline: none; }
        body { margin: 0; background: var(--bg); color: white; font-family: 'Courier New', monospace; overflow-x: hidden; }

        /* Background Layer */
        #global-canvas { position: fixed; top:0; left:0; width:100%; height:100%; z-index: -1; pointer-events: none; }

        /* Loader */
        #loader { position: fixed; inset: 0; background: #000; z-index: 100000; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .bar-wrap { width: 250px; height: 4px; background: #111; border: 1px solid #333; margin-top: 20px; }
        #bar { width: 0%; height: 100%; background: var(--primary); box-shadow: 0 0 15px var(--primary); transition: 0.1s; }

        /* UI Navigation Hub */
        .hub { position: fixed; bottom: 30px; right: 30px; z-index: 9999; display: flex; flex-direction: column-reverse; gap: 15px; align-items: center; }
        .hub-main { width: 65px; height: 65px; background: var(--primary); border: 4px solid #fff; border-radius: 50%; box-shadow: 0 0 20px var(--primary); font-size: 28px; color: #000; border: none; cursor: pointer; }
        .hub-menu { display: none; flex-direction: column; gap: 10px; }
        .hub-btn { width: 50px; height: 50px; background: #000; border: 2px solid var(--primary); border-radius: 50%; color: var(--primary); display: flex; align-items: center; justify-content: center; font-size: 20px; cursor: pointer; transition: 0.2s; }
        .hub-btn:hover { background: var(--primary); color: #000; box-shadow: 0 0 10px var(--primary); }

        header { padding: 40px; text-align: center; font-size: 35px; color: var(--primary); text-shadow: 0 0 15px var(--primary); letter-spacing: 5px; cursor: pointer; position: relative; z-index: 10; }

        /* Product Cards Layout */
        .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 20px; padding: 20px; max-width: 1200px; margin: auto; min-height: 200px; }
        .card { background: var(--glass); border: 1px solid #222; padding: 15px; border-radius: 8px; position: relative; overflow: hidden; transition: 0.3s; z-index: 10; }
        .card:hover { border-color: var(--primary); transform: translateY(-5px); }
        .card img { width: 100%; height: 160px; object-fit: cover; border-radius: 4px; }
        .card h3 { margin: 15px 0 5px; font-size: 18px; color: #fff; }
        .price { color: var(--price); font-weight: bold; font-size: 22px; margin-bottom: 15px; }

        /* Pages */
        .page { display: none; padding: 20px; position: relative; z-index: 10; }
        #shop-page { display: block; }

        /* Admin Terminal */
        .admin-panel { display: none; position: fixed; inset: 0; background: #000; z-index: 50000; padding: 40px; overflow-y: auto; text-align: left; }
        .grid-3 { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .box { background: #0a0a0a; border: 1px solid #333; padding: 20px; border-radius: 4px; }
        input, select, textarea { width: 100%; padding: 12px; background: #000; border: 1px solid #444; color: #fff; margin: 8px 0; }
        .ui-btn { padding: 12px 25px; background: var(--primary); color: #000; font-weight: bold; border: none; cursor: pointer; transition: 0.2s; }
        .ui-btn:hover { box-shadow: 0 0 15px var(--primary); filter: brightness(1.1); }

        /* Biometric & PayPal Overlays */
        .overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.98); z-index: 100000; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
        .scan-line { width: 250px; height: 2px; background: var(--primary); position: absolute; animation: scan 2s infinite ease-in-out; }
        @keyframes scan { 0%, 100% { top: 35%; } 50% { top: 65%; } }

        #alert-banner { display: none; position: fixed; top: 0; width: 100%; background: var(--secondary); padding: 12px; z-index: 100001; font-weight: bold; text-align: center; border-bottom: 2px solid #fff; }
    </marquee>
    </style>
</head>
<body onclick="startAudio()">

<div id="alert-banner"></div>

<div id="loader">
    <div style="color:var(--primary); font-size: 12px; white-space: pre;">[ SYSTEM INITIALIZING ]</div>
    <div class="bar-wrap"><div id="bar"></div></div>
    <div id="load-logs" style="margin-top:10px; font-size:10px; color:#0f0;">Checking root...</div>
</div>

<canvas id="global-canvas"></canvas>

<div class="overlay" id="scan-overlay">
    <div style="border:2px solid var(--primary); padding: 50px; border-radius: 50%;"><span style="font-size: 40px;">üëÅÔ∏è</span></div>
    <div class="scan-line"></div>
    <h2 style="color:var(--primary); margin-top:30px; letter-spacing:5px;">AUTH_REQUIRED</h2>
    <p id="scan-status" style="color:#0f0;">SCANNING RETINA...</p>
</div>

<div class="overlay" id="pay-overlay">
    <div style="background:#000; border:1px solid var(--primary); padding:40px; width: 90%; max-width: 450px;">
        <h2 style="color:var(--primary)">SECURE GATEWAY</h2>
        <div id="paypal-btn-container" style="margin:20px 0;"></div>
        <button onclick="document.getElementById('pay-overlay').style.display='none'" class="ui-btn" style="background:red; color:white;">ABORT</button>
    </div>
</div>

<div class="hub">
    <button class="hub-main" onclick="toggleHub()">‚öîÔ∏è</button>
    <div class="hub-menu" id="hub-menu">
        <div class="hub-btn" onclick="showPage('shop-page')">üè†</div>
        <div class="hub-btn" onclick="showPage('cart-page')">üõí</div>
        <div class="hub-btn" onclick="toggleTheme()">üåÄ</div>
    </div>
</div>

<header onclick="showPage('shop-page')">SPR SHOP ARK R4</header>

<div id="shop-page" class="page">
    <div style="text-align:center; color:var(--primary); margin-bottom: 20px;">[ ARSENAL_MODULES ]</div>
    <div style="color:var(--primary); padding:10px; font-weight:bold; border-bottom:1px solid var(--primary); max-width:1200px; margin:auto;">ANDROID_CHEATS</div>
    <div id="android-grid" class="product-grid"></div>
    <div style="color:var(--primary); padding:10px; font-weight:bold; border-bottom:1px solid var(--primary); max-width:1200px; margin:auto; margin-top:40px;">IOS_CHEATS</div>
    <div id="ios-grid" class="product-grid"></div>
</div>

<div id="info-page" class="page">
    <div style="max-width:800px; margin:auto; background:var(--glass); border:1px solid var(--primary); padding:30px;">
        <button onclick="showPage('shop-page')" class="ui-btn" style="margin-bottom:20px;">‚¨Ö BACK</button>
        <img id="info-img" style="width:100%; max-height:400px; object-fit:contain;">
        <h1 id="info-title" style="color:var(--primary)"></h1>
        <div id="info-price" class="price"></div>
        <p id="info-desc" style="line-height:1.6;"></p>
        <div id="info-actions" style="display:flex; flex-direction:column; gap:10px;"></div>
    </div>
</div>

<div id="cart-page" class="page">
    <div style="max-width:600px; margin:auto; background:var(--glass); border:1px solid var(--primary); padding:30px;">
        <h2 style="color:var(--primary)">MANIFEST</h2>
        <div id="cart-items" style="text-align:left; border-left: 2px solid var(--primary); padding-left:20px; margin:20px 0;"></div>
        <div style="display:flex; gap:10px;">
            <input type="text" id="coupon-in" placeholder="COUPON_CODE">
            <button onclick="applyCoupon()" class="ui-btn">VALIDATE</button>
        </div>
        <h1 id="total-val" style="color:var(--price); font-size:40px;">TOTAL: $0</h1>
        <button onclick="checkout()" class="ui-btn" style="width:100%; padding:20px; font-size:20px;">‚öîÔ∏è FINISH PURCHASE</button>
        <p onclick="clearCart()" style="color:red; cursor:pointer; margin-top:20px; font-size:12px;">[ WIPE_CART ]</p>
    </div>
</div>

<div class="admin-panel" id="admin-panel">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:40px;">
        <h2 style="color:red;">R4_ROOT_TERMINAL</h2>
        <button onclick="document.getElementById('admin-panel').style.display='none'" class="ui-btn" style="background:red; color:white;">LOGOUT</button>
    </div>

    <div id="admin-login" style="text-align:center; padding-top:100px;">
        <input type="password" id="root-pass" placeholder="ROOT KEY" style="max-width:400px;">
        <button onclick="adminLogin()" class="ui-btn" style="width:400px; margin-top:20px;">DECRYPT</button>
    </div>

    <div id="admin-ui" style="display:none;" class="grid-3">
        <div class="box">
            <h3>üì° INTEL_FEED</h3>
            <div id="intel-log" style="font-size:11px; color:yellow; background:#000; height:200px; overflow-y:auto; padding:10px; border:1px solid #222;"></div>
            <h3 style="margin-top:20px;">üéüÔ∏è COUPONS</h3>
            <input id="c-code" placeholder="CODE"><input id="c-perc" placeholder="DISCOUNT %">
            <button onclick="saveCoupon()" class="ui-btn" style="width:100%;">DEPLOY COUPON</button>
        </div>
        <div class="box">
            <h3>‚öíÔ∏è ARSENAL FORGE</h3>
            <input type="hidden" id="edit-id" value="-1">
            <input id="p-name" placeholder="PRODUCT NAME"><input id="p-price" placeholder="PRICE">
            <input id="p-yt" placeholder="YOUTUBE ID">
            <select id="p-cat"><option value="android">Android</option><option value="ios">IOS</option></select>
            <textarea id="p-desc" placeholder="DESCRIPTION" style="height:80px;"></textarea>
            <label style="font-size:10px;">IMAGE:</label><input type="file" id="p-img">
            <label style="font-size:10px;">DELIVERY FILE:</label><input type="file" id="p-file">
            <button id="save-btn" onclick="saveProduct()" class="ui-btn" style="width:100%;">DEPLOY ASSET</button>
            <button id="cancel-edit" onclick="resetForge()" class="ui-btn" style="width:100%; background:gray; margin-top:5px; display:none;">CANCEL</button>
            <div id="inventory-list" style="margin-top:20px; border-top:1px solid #333; padding-top:10px;"></div>
        </div>
        <div class="box">
            <h3>üõ°Ô∏è FIREWALL</h3>
            <input id="ban-ip" placeholder="TARGET IP">
            <button onclick="banIP()" class="ui-btn" style="width:100%; background:red; color:white;">BLOCK IP</button>
            <h3 style="margin-top:20px;">üì¢ BROADCAST</h3>
            <input id="bc-msg" placeholder="SYSTEM MESSAGE">
            <button onclick="db.ref('settings/broadcast').set(document.getElementById('bc-msg').value)" class="ui-btn" style="width:100%; background:orange;">SEND ALERT</button>
        </div>
    </div>
</div>

<audio id="hacker-music" loop><source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3"></audio>
<audio id="snd-click" src="https://www.myinstants.com/media/sounds/sword-slash.mp3" preload="auto"></audio>

<script>
let products = [], cart = [], coupons = {}, isAdmin = false, discount = 0, musicOn = false;

// Audio & UI
function startAudio() { if(!musicOn) { document.getElementById('hacker-music').play().catch(()=>{}); musicOn = true; } }
function playClick() { const s = document.getElementById('snd-click'); s.currentTime = 0; s.play().catch(()=>{}); }
function toggleHub() { const m = document.getElementById('hub-menu'); m.style.display = (m.style.display==='flex'?'none':'flex'); playClick(); }
function showPage(id) {
    document.querySelectorAll('.page').forEach(p => p.style.display = 'none');
    document.getElementById(id).style.display = 'block';
    window.scrollTo(0,0);
    playClick();
}
function toggleTheme() { document.body.classList.toggle('blue-theme'); playClick(); }

// Core Shop Logic
function loadData() {
    db.ref('products').on('value', snap => {
        products = snap.val() || [];
        const ag = document.getElementById('android-grid'), ig = document.getElementById('ios-grid');
        ag.innerHTML = ""; ig.innerHTML = "";
        products.forEach((p, i) => {
            if(!p) return;
            const div = document.createElement('div'); div.className = 'card';
            div.innerHTML = `<img src="${p.image||''}" onclick="viewItem(${i})"><h3>${p.name}</h3><div class="price">$${p.price}</div><button class="ui-btn" style="width:100%;" onclick="addToCart(${i})">ADD TO CART</button>`;
            (p.category==='ios'?ig:ag).appendChild(div);
        });
        if(isAdmin) renderAdminList();
    });
}

function addToCart(i) {
    playClick();
    cart.push(products[i]);
    fetch('https://api.ipify.org?format=json').then(r=>r.json()).then(d=>db.ref('intel').push(`CART_ADD | ${d.ip} | ${products[i].name}`));
}

function viewItem(i) {
    const p = products[i];
    showPage('info-page');
    document.getElementById('info-img').src = p.image || '';
    document.getElementById('info-title').innerText = p.name;
    document.getElementById('info-price').innerText = "$"+p.price;
    document.getElementById('info-desc').innerText = p.desc;
    document.getElementById('info-actions').innerHTML = `<button class="ui-btn" onclick="addToCart(${i})">ADD TO MANIFEST</button>${p.yt ? `<button class="ui-btn" style="background:red;color:white;" onclick="window.open('https://youtube.com/watch?v=${p.yt}')">WATCH PREVIEW</button>` : ''}`;
}

function renderCart() {
    const list = document.getElementById('cart-items');
    let total = 0; list.innerHTML = "";
    cart.forEach((item, idx) => {
        list.innerHTML += `<div style="display:flex;justify-content:space-between;margin-bottom:10px;"><span>> ${item.name}</span><span>$${item.price}</span></div>`;
        total += parseFloat(item.price);
    });
    let final = total - (total * (discount/100));
    document.getElementById('total-val').innerText = "TOTAL: $" + final.toFixed(2);
}

function clearCart() { cart = []; renderCart(); }

function checkout() {
    if(cart.length === 0) return;
    document.getElementById('scan-overlay').style.display = 'flex';
    setTimeout(() => {
        document.getElementById('scan-status').innerText = "IDENTITY CONFIRMED";
        setTimeout(() => {
            document.getElementById('scan-overlay').style.display = 'none';
            document.getElementById('pay-overlay').style.display = 'flex';
            startPayPal();
        }, 1500);
    }, 2000);
}

function startPayPal() {
    document.getElementById('paypal-btn-container').innerHTML = '';
    let t = 0; cart.forEach(i=>t+=parseFloat(i.price));
    let final = (t - (t * (discount/100))).toFixed(2);
    paypal.Buttons({
        createOrder: (data, actions) => actions.order.create({ purchase_units: [{ amount: { value: final } }] }),
        onApprove: (data, actions) => actions.order.capture().then(det => {
            cart.forEach(item => { if(item.delivery) { const a=document.createElement('a'); a.href=item.delivery.data; a.download=item.delivery.name; a.click(); } });
            alert("PAYMENT SUCCESSFUL"); location.reload();
        })
    }).render('#paypal-btn-container');
}

// Admin Hub Logic
window.onkeydown = (e) => { if(e.key === "Insert") document.getElementById('admin-panel').style.display = 'block'; };
function adminLogin() {
    if(document.getElementById('root-pass').value === "spartytop1") {
        isAdmin = true;
        document.getElementById('admin-ui').style.display = 'grid';
        document.getElementById('admin-login').style.display = 'none';
        db.ref('intel').limitToLast(40).on('value', s => {
            const logs = s.val() ? Object.values(s.val()).reverse() : [];
            document.getElementById('intel-log').innerHTML = logs.map(l => `<div>> ${l}</div>`).join('');
        });
        db.ref('coupons').on('value', s => coupons = s.val() || {});
        renderAdminList();
    }
}

function saveProduct() {
    const n=document.getElementById('p-name').value, p=document.getElementById('p-price').value, y=document.getElementById('p-yt').value, c=document.getElementById('p-cat').value, d=document.getElementById('p-desc').value, fImg=document.getElementById('p-img').files[0], fFile=document.getElementById('p-file').files[0], idx=document.getElementById('edit-id').value;
    const read = (file) => file ? new Promise(res => { const r=new FileReader(); r.onload=e=>res({data:e.target.result, name:file.name}); r.readAsDataURL(file); }) : null;
    Promise.all([read(fImg), read(fFile)]).then(vals => {
        let obj = { name:n, price:p, yt:y, category:c, desc:d, image: vals[0]?vals[0].data : (idx!=-1?products[idx].image:""), delivery: vals[1] || (idx!=-1?products[idx].delivery:null) };
        if(idx == -1) products.push(obj); else products[idx] = obj;
        db.ref('products').set(products).then(() => { alert("MANIFEST DEPLOYED"); resetForge(); });
    });
}

function renderAdminList() {
    document.getElementById('inventory-list').innerHTML = products.map((p, i) => p ? `
        <div style="display:flex;justify-content:space-between;padding:8px;border-bottom:1px solid #222;font-size:12px;">
            <span>${p.name}</span>
            <div>
                <button onclick="editItem(${i})" style="color:lime;background:none;border:none;cursor:pointer;">[EDIT]</button>
                <button onclick="deleteItem(${i})" style="color:red;background:none;border:none;cursor:pointer;margin-left:10px;">[DEL]</button>
            </div>
        </div>
    ` : '').join('');
}

function editItem(i) {
    const p = products[i];
    document.getElementById('p-name').value = p.name;
    document.getElementById('p-price').value = p.price;
    document.getElementById('p-yt').value = p.yt || '';
    document.getElementById('p-cat').value = p.category;
    document.getElementById('p-desc').value = p.desc;
    document.getElementById('edit-id').value = i;
    document.getElementById('save-btn').innerText = "CONFIRM UPDATE";
    document.getElementById('cancel-edit').style.display = "block";
    document.getElementById('admin-panel').scrollTop = 0;
}

function deleteItem(i) { if(confirm("DELETE?")) { products.splice(i,1); db.ref('products').set(products); } }
function resetForge() { document.getElementById('edit-id').value = "-1"; document.getElementById('save-btn').innerText="DEPLOY ASSET"; document.getElementById('cancel-edit').style.display="none"; }
function banIP() { const ip = document.getElementById('ban-ip').value; db.ref('banned_ips').once('value', s => { let l=s.val()||[]; l.push(ip); db.ref('banned_ips').set(l); }); }
function saveCoupon() { db.ref('coupons/'+document.getElementById('c-code').value.toUpperCase()).set(document.getElementById('c-perc').value); }
function applyCoupon() { const c = document.getElementById('coupon-in').value.toUpperCase(); if(coupons[c]) { discount = coupons[c]; renderCart(); alert("DISCOUNT APPLIED"); } else alert("INVALID"); }

// Matrix Background
const canvas = document.getElementById('global-canvas'), ctx = canvas.getContext('2d');
let drops = [];
function drawMatrix() {
    ctx.fillStyle = "rgba(0,0,0,0.1)"; ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle = "#ffd700"; ctx.font = "15px monospace";
    drops.forEach((y, i) => { ctx.fillText(String.fromCharCode(0x30A0 + Math.random()*33), i*20, y*20); if(y*20 > canvas.height && Math.random() > 0.975) drops[i] = 0; drops[i]++; });
}

window.onload = () => {
    canvas.width = window.innerWidth; canvas.height = window.innerHeight;
    drops = Array(Math.floor(canvas.width/20)).fill(1);
    setInterval(drawMatrix, 50);
    loadData();
    db.ref('settings/broadcast').on('value', s => {
        const b = document.getElementById('alert-banner');
        if(s.val()) { b.innerText = "‚ö†Ô∏è SYSTEM: " + s.val(); b.style.display = 'block'; } else b.style.display = 'none';
    });
    let p = 0; let int = setInterval(() => {
        p += 2; document.getElementById('bar').style.width = p + "%";
        if(p >= 100) { clearInterval(int); document.getElementById('loader').style.display='none'; }
    }, 30);
};
</script>
</body>
</html>
