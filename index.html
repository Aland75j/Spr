<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MAXIOM R4 | MASTER ELITE</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDE6qMplWktZASB2AjUKuY_dSRCUKiZyOA",
            authDomain: "maxiom-r3.firebaseapp.com",
            databaseURL: "https://maxiom-r3-default-rtdb.firebaseio.com",
            projectId: "maxiom-r3",
            storageBucket: "maxiom-r3.firebasestorage.app",
            messagingSenderId: "221473460329",
            appId: "1:221473460329:web:21a278a86cfdcff8b1d2f8",
            measurementId: "G-82WFV6S568"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        (function() {
            db.ref('settings/paypal_id').once('value', (snap) => {
                const savedID = snap.val() || "test";
                const script = document.createElement('script');
                script.src = `https://www.paypal.com/sdk/js?client-id=${savedID}&currency=USD`;
                document.head.appendChild(script);
            });
        })();
    </script>

    <style>
        :root {
            --primary: #00d4ff; 
            --secondary: #00ff41; 
            --bg-main: #02050a;
            --glass: rgba(0, 10, 20, 0.9);
            --price-gold: #ffd700;
        }
        * { cursor: crosshair !important; box-sizing: border-box; font-family: 'Courier New', monospace; }
        body { margin: 0; background: var(--bg-main); color: white; overflow-x: hidden; padding-bottom: 100px; }

        #global-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -2; opacity: 0.5; }

        /* [4] Neural Hub */
        .neural-hub { position: fixed; bottom: 30px; right: 30px; z-index: 1000; }
        .hub-main { width: 60px; height: 60px; background: var(--primary); border-radius: 50%; border: none; font-size: 24px; box-shadow: 0 0 20px var(--primary); cursor: pointer; transition: 0.3s; }
        .hub-menu { display: none; position: absolute; bottom: 70px; right: 0; flex-direction: column; gap: 10px; }
        .hub-item { width: 50px; height: 50px; background: black; border: 1px solid var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: var(--primary); text-decoration: none; cursor: pointer; }

        /* [2] Biometric Overlay */
        #biometric-scan { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 100000; flex-direction: column; align-items: center; justify-content: center; }
        .eye-scanner { width: 200px; height: 100px; border: 2px solid var(--primary); border-radius: 50% 50% 0 0; position: relative; overflow: hidden; }
        .scan-bar { position: absolute; width: 100%; height: 2px; background: var(--primary); box-shadow: 0 0 15px var(--primary); animation: scanMove 2s infinite; }
        @keyframes scanMove { 0% { top: 0; } 100% { top: 100%; } }

        /* [3] Ghost Hover Product */
        .product { background: var(--glass); width: 280px; padding: 15px; border: 1px solid #111; border-top: 3px solid var(--primary); position: relative; overflow: hidden; transition: 0.3s; }
        .product:hover { transform: scale(1.02); border-color: var(--primary); box-shadow: 0 0 20px var(--primary); }
        .hex-dump { position: absolute; top: 0; left: 0; width: 100%; height: 100%; font-size: 8px; color: rgba(0, 212, 255, 0.05); pointer-events: none; word-break: break-all; opacity: 0; transition: 0.5s; }
        .product:hover .hex-dump { opacity: 1; transform: translateY(-20px); }

        /* [8] Support Terminal */
        #support-box { display: none; position: fixed; bottom: 100px; left: 20px; width: 300px; height: 350px; background: black; border: 1px solid var(--secondary); z-index: 999; padding: 10px; flex-direction: column; }

        /* Core Layout */
        .cat-title { font-size: 24px; color: var(--primary); margin: 40px; border-left: 4px solid var(--primary); padding-left: 15px; text-align: left; max-width: 900px; margin-inline: auto; }
        .grid { display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; }
        .ui-btn { padding: 10px 20px; background: transparent; color: var(--primary); border: 1px solid var(--primary); cursor: pointer; font-weight: bold; }
        .ui-btn:hover { background: var(--primary); color: black; }

        #auth-overlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background: radial-gradient(circle, #1a1400 0%, #000 100%); z-index:99999; flex-direction:column; align-items:center; justify-content:center; }
        .admin-box { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 20000; padding: 50px; text-align: left; overflow-y: auto; }
    </style>
</head>
<body onclick="startAudio()">

<canvas id="global-canvas"></canvas>

<div id="biometric-scan">
    <div class="eye-scanner"><div class="scan-bar"></div></div>
    <h2 style="color:var(--primary); letter-spacing: 5px; margin-top: 20px;">RETINA IDENTITY CHECK</h2>
    <p style="color:var(--secondary); font-size: 10px;">ID: UNKNOWN | AUTH_LEVEL: MASTER</p>
</div>

<div id="support-box">
    <div style="border-bottom:1px solid var(--secondary); padding-bottom:5px; margin-bottom:10px; display:flex; justify-content:space-between;">
        <span style="color:var(--secondary)">ENCRYPTED_COMMS</span>
        <span onclick="toggleSupport()" style="cursor:pointer; color:red;">[X]</span>
    </div>
    <div id="sup-logs" style="flex:1; font-size:10px; color:var(--secondary); overflow-y:auto;">> Connection established...</div>
    <input type="text" id="sup-msg" placeholder="TYPE MESSAGE..." onkeydown="if(event.key==='Enter') sendSup()" style="background:#000; border:1px solid #333; color:var(--secondary); width:100%; padding:5px; margin-top:10px;">
</div>

<div class="neural-hub">
    <div class="hub-menu" id="hub-menu">
        <div class="hub-item" onclick="showShop()" title="Home">üè†</div>
        <div class="hub-item" onclick="showCheckout()" title="Cart">üõí</div>
        <div class="hub-item" onclick="toggleSupport()" title="Support">üì°</div>
    </div>
    <button class="hub-main" onclick="toggleHub()">‚öîÔ∏è</button>
</div>

<header style="padding:40px; font-size: 40px; color:var(--primary); text-shadow: 0 0 10px var(--primary); cursor:pointer;" onclick="showShop()">SPR SHOP ARK R4</header>

<div id="shop-page">
    <div class="cat-title">ANDROID_MODULES</div>
    <div id="android-grid" class="grid"></div>
    <div class="cat-title">IOS_MODULES</div>
    <div id="ios-grid" class="grid"></div>
</div>

<div id="checkout-page" style="display:none; padding:40px;">
    <div style="max-width:600px; margin:auto; background:var(--glass); border:1px solid var(--primary); padding:30px;">
        <h2 style="color:var(--primary)">MANIFEST_SUMMARY</h2>
        <div id="cart-list" style="text-align:left; border-left: 2px solid var(--primary); padding-left:15px; margin:20px 0;"></div>
        <h1 id="total-usd" style="color:var(--price-gold)">TOTAL: $0</h1>
        <button onclick="triggerHackerPay()" class="ui-btn" style="width:100%; height:60px; background:var(--price-gold); color:black; font-size:20px;">‚öîÔ∏è INITIALIZE UPLINK</button>
        <button onclick="showShop()" style="background:none; border:none; color:gray; margin-top:20px; cursor:pointer;">[ BACK TO SHOP ]</button>
    </div>
</div>

<div id="auth-overlay">
    <div style="background:rgba(0,0,0,0.9); border:1px solid var(--price-gold); padding:40px; text-align:center; max-width:450px;">
        <h1 style="color:var(--price-gold)">GOLD_GATEWAY</h1>
        <p id="pay-status" style="color:var(--secondary)">>>> WAITING FOR AUTHORIZATION...</p>
        <div id="paypal-button-container"></div>
        <button onclick="document.getElementById('auth-overlay').style.display='none'" class="ui-btn" style="border-color:red; color:red; margin-top:20px;">ABORT</button>
    </div>
</div>

<div class="admin-box" id="admin-terminal">
    <div style="display:flex; justify-content:space-between;">
        <h2 style="color:var(--secondary)">MASTER_CONTROL</h2>
        <button onclick="document.getElementById('admin-terminal').style.display='none'" class="ui-btn">EXIT</button>
    </div>
    <div id="login-sec" style="text-align:center; margin-top:100px;">
        <input type="password" id="admin-pass" placeholder="ACCESS_KEY" style="padding:15px; width:300px; background:#000; border:1px solid var(--primary); color:white;">
        <button onclick="login()" class="ui-btn">DECRYPT</button>
    </div>
    <div id="admin-controls" style="display:none; margin-top:30px;">
        <div style="background:#111; padding:20px; border:1px solid #333;">
            <h3>ASSET_FORGE</h3>
            <input type="text" id="p-name" placeholder="Name">
            <input type="number" id="p-price" placeholder="Price">
            <select id="p-cat"><option value="android">Android</option><option value="ios">IOS</option></select>
            <textarea id="p-desc" placeholder="Description"></textarea>
            <input type="file" id="p-img" accept="image/*">
            <input type="file" id="p-file">
            <button onclick="addProduct()" class="ui-btn" style="width:100%; margin-top:10px;">DEPLOY</button>
        </div>
    </div>
</div>

<audio id="snd-hover" src="https://www.myinstants.com/media/sounds/button-19.mp3"></audio>
<audio id="snd-click" src="https://www.myinstants.com/media/sounds/sci-fi-click.mp3"></audio>
<audio id="hacker-music" loop><source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-15.mp3"></audio>

<script>
let products = [], cart = [], isAdmin = false, musicStarted = false;

// [4] Neural Hub Toggle
function toggleHub() {
    let m = document.getElementById('hub-menu');
    m.style.display = (m.style.display === 'flex') ? 'none' : 'flex';
    playSnd('snd-click');
}

// [8] Support Terminal
function toggleSupport() {
    let s = document.getElementById('support-box');
    s.style.display = (s.style.display === 'flex') ? 'none' : 'flex';
}
function sendSup() {
    let i = document.getElementById('sup-msg'), l = document.getElementById('sup-logs');
    if(!i.value) return;
    l.innerHTML += `<div>> YOU: ${i.value}</div>`;
    i.value = "";
    setTimeout(() => { l.innerHTML += `<div style="color:var(--primary)">> SYSTEM: Message Encrypted & Sent.</div>`; }, 1000);
}

// [9] Sound Engine
function playSnd(id) { let s = document.getElementById(id); if(s) { s.currentTime=0; s.play().catch(()=>{}); } }

// Core Shop Logic
function displayProducts() {
    db.ref('products').on('value', (snap) => {
        products = snap.val() || [];
        const android = document.getElementById("android-grid"), ios = document.getElementById("ios-grid");
        if(!android) return;
        android.innerHTML = ""; ios.innerHTML = "";
        products.forEach((p, i) => {
            if(!p) return;
            const div = document.createElement("div"); div.className = "product";
            div.onmouseenter = () => playSnd('snd-hover');
            div.innerHTML = `
                <div class="hex-dump">0x55 0xAA 0xFF 0x00 0x11 0x22 0x33 0x44 0x55 0x66 0x77 0x88 0x99 0xAA</div>
                <img src="${p.image || ''}" style="width:100%; height:150px; object-fit:cover;">
                <h3 style="color:var(--primary)">${p.name}</h3>
                <div style="color:var(--price-gold)">$${p.price}</div>
                <button onclick="addToCart(${i})" class="ui-btn" style="width:100%; margin-top:10px;">ADD TO CART</button>
            `;
            p.category === "ios" ? ios.appendChild(div) : android.appendChild(div);
        });
    });
}

function addToCart(i) { playSnd('snd-click'); cart.push(products[i]); }
function showCheckout() { document.getElementById('shop-page').style.display='none'; document.getElementById('checkout-page').style.display='block'; renderCart(); }
function showShop() { document.getElementById('shop-page').style.display='block'; document.getElementById('checkout-page').style.display='none'; }

function renderCart() {
    let l = document.getElementById('cart-list'), t = 0;
    l.innerHTML = "";
    cart.forEach((item, index) => {
        l.innerHTML += `<div style="margin-bottom:10px; display:flex; justify-content:space-between;">
            <span>> ${item.name}</span>
            <span style="color:var(--price-gold)">$${item.price}</span>
        </div>`;
        t += parseFloat(item.price);
    });
    document.getElementById('total-usd').innerText = "TOTAL: $" + t.toFixed(2);
}

// [2] Trigger Hacker Pay with Biometric Scan
function triggerHackerPay() {
    if(cart.length === 0) return alert("CART EMPTY");
    document.getElementById('biometric-scan').style.display = 'flex';
    
    setTimeout(() => {
        document.getElementById('biometric-scan').style.display = 'none';
        document.getElementById('auth-overlay').style.display = 'flex';
        renderPaypal();
    }, 2500);
}

function renderPaypal() {
    document.getElementById('paypal-button-container').innerHTML = '';
    let t = 0; cart.forEach(i => t += parseFloat(i.price));
    paypal.Buttons({
        style: { color: 'gold', shape: 'rect' },
        createOrder: (data, actions) => actions.order.create({ purchase_units: [{ amount: { value: t.toFixed(2) } }] }),
        onApprove: (data, actions) => actions.order.capture().then(det => {
            alert("TRANSACTION SUCCESS"); location.reload();
        })
    }).render('#paypal-button-container');
}

// Admin Logic (INSERT KEY)
window.onkeydown = (e) => { if(e.key === "Insert") document.getElementById('admin-terminal').style.display = 'block'; };
function login() {
    if(document.getElementById('admin-pass').value === "spartytop1") {
        document.getElementById('admin-controls').style.display = 'block';
        document.getElementById('login-sec').style.display = 'none';
    }
}
function addProduct() {
    const n=document.getElementById('p-name').value, p=document.getElementById('p-price').value, c=document.getElementById('p-cat').value, d=document.getElementById('p-desc').value, fImg=document.getElementById('p-img').files[0], fFile=document.getElementById('p-file').files[0];
    const read = (file) => file ? new Promise(res => { const r=new FileReader(); r.onload=e=>res({data:e.target.result, name:file.name}); r.readAsDataURL(file); }) : null;
    Promise.all([read(fImg), read(fFile)]).then(vals => {
        products.push({ name:n, price:p, category:c, desc:d, image: vals[0] ? vals[0].data : "", delivery: vals[1] || null });
        db.ref('products').set(products).then(() => alert("DEPLOYED"));
    });
}

// Background Grid
const canvas = document.getElementById('global-canvas'); const ctx = canvas.getContext('2d'); let dots = [];
function initDots() { dots = []; for(let i=0; i<80; i++) dots.push({ x: Math.random()*canvas.width, y: Math.random()*canvas.height, vx: (Math.random()-0.5), vy: (Math.random()-0.5) }); }
function drawGrid() {
    ctx.clearRect(0,0,canvas.width, canvas.height);
    dots.forEach((d, i) => {
        d.x += d.vx; d.y += d.vy;
        if(d.x<0 || d.x>canvas.width) d.vx *= -1; if(d.y<0 || d.y>canvas.height) d.vy *= -1;
        ctx.fillStyle = "rgba(0, 212, 255, 0.4)"; ctx.beginPath(); ctx.arc(d.x, d.y, 2, 0, Math.PI*2); ctx.fill();
        for(let j=i+1; j<dots.length; j++) {
            let dist = Math.hypot(d.x-dots[j].x, d.y-dots[j].y);
            if(dist < 100) { ctx.strokeStyle = "rgba(0, 212, 255, 0.1)"; ctx.beginPath(); ctx.moveTo(d.x, d.y); ctx.lineTo(dots[j].x, dots[j].y); ctx.stroke(); }
        }
    });
    requestAnimationFrame(drawGrid);
}

window.onload = () => { canvas.width = window.innerWidth; canvas.height = window.innerHeight; initDots(); drawGrid(); displayProducts(); };
function startAudio() { if(!musicStarted) { document.getElementById('hacker-music').play(); musicStarted = true; } }
</script>
</body>
</html>
