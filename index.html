<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MAXIOM R4 | MASTER EDITION</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDE6qMplWktZASB2AjUKuY_dSRCUKiZyOA",
            authDomain: "maxiom-r3.firebaseapp.com",
            databaseURL: "https://maxiom-r3-default-rtdb.firebaseio.com",
            projectId: "maxiom-r3",
            storageBucket: "maxiom-r3.firebasestorage.app",
            messagingSenderId: "221473460329",
            appId: "1:221473460329:web:21a278a86cfdcff8b1d2f8",
            measurementId: "G-82WFV6S568"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        (function() {
            const checkBans = async () => {
                try {
                    const r = await fetch('https://api.ipify.org?format=json');
                    const d = await r.json();
                    const userIP = d.ip;
                    db.ref('banned_ips').on('value', (snap) => {
                        const list = snap.val() || [];
                        if(list.includes(userIP)) {
                            window.stop();
                            document.documentElement.innerHTML = "";
                            alert("IP TERMINATED BY SYSTEM ADMIN");
                            window.location.href = "about:blank";
                        }
                    });
                } catch(e) { console.log("Shield Active"); }
            };
            checkBans();
            db.ref('settings/paypal_id').once('value', (snap) => {
                const savedID = snap.val() || "test";
                const script = document.createElement('script');
                script.src = `https://www.paypal.com/sdk/js?client-id=${savedID}&currency=USD`;
                document.head.appendChild(script);
            });
        })();
    </script>

    <style>
        :root {
            --primary: #00d4ff; 
            --secondary: #00ff41; 
            --matrix: rgba(0, 212, 255, 0.15);
            --bg-main: #02050a;
            --glass: rgba(0, 10, 20, 0.7);
            --price-gold: #ffd700;
            --glow: 0 0 15px var(--primary);
        }

        * { cursor: crosshair !important; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { 
            margin: 0; font-family: 'Courier New', monospace; color: white; text-align: center; 
            background: var(--bg-main); overflow-x: hidden; padding-bottom: 80px; 
        }

        /* [7] Glassmorphism Panels */
        .glass-panel {
            background: var(--glass);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 8px 32px 0 rgba(0,0,0,0.8);
        }

        header { 
            font-size: 50px; font-weight: bold; color: var(--primary); 
            text-shadow: var(--glow); letter-spacing: 10px; animation: glitch 3s infinite;
        }

        /* [3] Ghost Hover Effect */
        .product { 
            background: var(--glass); padding: 15px; width: 270px; 
            border: 1px solid #111; border-top: 3px solid var(--primary);
            transition: 0.3s; position: relative; overflow: hidden;
        }
        .product::before {
            content: "010111001010101011010101011110101010101011101010101011101010101";
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            font-size: 10px; color: rgba(0,212,255,0.05); word-break: break-all;
            opacity: 0; transition: 0.5s; pointer-events: none;
        }
        .product:hover::before { opacity: 1; transform: translateY(-20px); }
        .product:hover { transform: translateY(-5px); border-color: var(--primary); box-shadow: var(--glow); }

        /* [4] Neural Hub (Radial Button) */
        .neural-hub {
            position: fixed; bottom: 60px; right: 20px; z-index: 10001;
        }
        .hub-btn {
            width: 60px; height: 60px; background: var(--primary); border-radius: 50%;
            border: none; color: black; font-size: 24px; cursor: pointer;
            box-shadow: 0 0 20px var(--primary); transition: 0.5s;
        }
        .hub-menu {
            position: absolute; bottom: 70px; right: 0; display: none;
            flex-direction: column; gap: 10px;
        }
        .hub-item {
            width: 50px; height: 50px; background: black; border: 1px solid var(--primary);
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            color: var(--primary); font-size: 18px; transition: 0.3s;
        }
        .hub-item:hover { background: var(--primary); color: black; transform: scale(1.2); }

        /* [2] Biometric Scan Overlay */
        #biometric-overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); z-index: 100001; flex-direction: column; align-items: center; justify-content: center;
        }
        .scanner-circle {
            width: 200px; height: 200px; border: 2px solid var(--primary); border-radius: 50%;
            position: relative; overflow: hidden; box-shadow: 0 0 50px var(--primary);
        }
        .scanner-line {
            position: absolute; width: 100%; height: 4px; background: var(--primary);
            top: 0; animation: scanLineMove 2s linear infinite; box-shadow: 0 0 15px var(--primary);
        }
        @keyframes scanLineMove { 0% { top: 0%; } 100% { top: 100%; } }

        /* [8] Support Terminal */
        #support-terminal {
            display: none; position: fixed; bottom: 80px; left: 20px; width: 300px; height: 400px;
            background: rgba(0,0,0,0.95); border: 1px solid var(--secondary); z-index: 9999;
            flex-direction: column; padding: 15px; font-size: 12px;
        }

        #global-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -2; }

        /* Page 3 Styles - Improved Gold Horizon */
        #auth-overlay {
            display:none; position:fixed; top:0; left:0; width:100%; height:100%; 
            background: radial-gradient(circle at center, #1a1400 0%, #02050a 100%);
            z-index:99999; flex-direction:column; align-items:center; justify-content:center;
        }
        .payment-box {
            width: 90%; max-width: 450px; padding: 40px; text-align: center; 
            border: 1px solid var(--price-gold); background: rgba(0,0,0,0.8);
            backdrop-filter: blur(20px); box-shadow: 0 0 50px rgba(255, 215, 0, 0.1);
        }

        /* Utils */
        .ui-btn { 
            padding: 10px 20px; background: rgba(0,0,0,0.5); color: var(--primary); 
            border: 1px solid var(--primary); font-weight: bold; cursor: pointer;
            transition: 0.3s; clip-path: polygon(10% 0, 100% 0, 90% 100%, 0 100%);
        }
        .ui-btn:hover { background: var(--primary); color: #000; box-shadow: var(--glow); }
        .floating-cart {
            position: fixed; top: 20px; right: 20px; background: var(--glass); width: 60px; height: 60px;
            display: flex; align-items: center; justify-content: center; cursor: pointer;
            z-index: 10000; color: var(--primary); border: 1px solid var(--primary);
        }
    </style>
</head>
<body onclick="startAudio()" onmousemove="updateMouse(event)">

<canvas id="global-canvas"></canvas>

<div id="biometric-overlay">
    <div class="scanner-circle"><div class="scanner-line"></div></div>
    <h2 style="color:var(--primary); margin-top: 30px; letter-spacing: 5px;">BIOMETRIC AUTHENTICATION</h2>
    <p style="color:var(--secondary); font-size: 10px;">ID_SCAN: [ MATCHED ] | SECURITY_CLEARANCE: [ OMEGA ]</p>
</div>

<div id="support-terminal" class="glass-panel">
    <div style="display:flex; justify-content: space-between; border-bottom: 1px solid var(--secondary); margin-bottom: 10px;">
        <span style="color:var(--secondary)">SECURE_CHANNEL_v8</span>
        <span onclick="toggleSupport()" style="color:red; cursor:pointer;">[X]</span>
    </div>
    <div id="support-msgs" style="flex:1; overflow-y:auto; color:var(--secondary); margin-bottom:10px;">
        > SYSTEM: Welcome to the private relay.<br>
        > SYSTEM: All comms are AES-256 encrypted.
    </div>
    <input type="text" id="sup-input" placeholder="Enter message..." onkeydown="if(event.key==='Enter') sendSupport()" style="background:#000; border:1px solid #333; color:var(--secondary); padding:5px;">
</div>

<div class="neural-hub">
    <div class="hub-menu" id="hub-menu">
        <div class="hub-item" onclick="showShop()" title="Home">üè†</div>
        <div class="hub-item" onclick="showCheckout()" title="Cart">üõí</div>
        <div class="hub-item" onclick="toggleSupport()" title="Support">üì°</div>
        <div class="hub-item" onclick="toggleTheme()" title="Switch Theme">üåÄ</div>
    </div>
    <button class="hub-btn" onclick="toggleHub()">‚öîÔ∏è</button>
</div>

<div id="global-alert-banner" style="display:none; position:fixed; top:0; width:100%; background:red; z-index:100002; padding:5px;"></div>

<div id="loader-overlay" style="position:fixed; top:0; left:0; width:100%; height:100%; background:#000; z-index:100003; display:flex; flex-direction:column; align-items:center; justify-content:center;">
    <div style="border:1px solid var(--primary); padding:20px; width:300px; text-align:left;">
        <div id="load-logs" style="color:var(--secondary); font-size:10px; height:100px; overflow:hidden;"></div>
        <div style="width:100%; height:5px; background:#111; margin-top:10px;"><div id="load-bar" style="width:0%; height:100%; background:var(--primary);"></div></div>
    </div>
</div>

<div class="header-container" style="padding: 40px 0;">
    <header onclick="showShop()" style="cursor:pointer;">SPR SHOP ARK R4</header>
</div>

<div class="floating-cart" onclick="showCheckout()">
    üõí <span id="cart-count">0</span>
</div>

<div id="shop-page">
    <div class="cat-label" style="font-size:20px; color:var(--primary); margin:20px;">[ ANDROID_ARSENAL ]</div>
    <div id="android-grid" class="product-grid" style="display:flex; flex-wrap:wrap; justify-content:center; gap:20px;"></div>
    <div class="cat-label" style="font-size:20px; color:var(--primary); margin:20px;">[ IOS_ARSENAL ]</div>
    <div id="ios-grid" class="product-grid" style="display:flex; flex-wrap:wrap; justify-content:center; gap:20px;"></div>
</div>

<div id="checkout-page" style="display:none; padding:20px;">
    <div class="glass-panel" style="max-width:600px; margin: auto; padding:30px;">
        <h2 style="color:var(--primary)">SECURE_INVENTORY</h2>
        <div id="cart-list" style="text-align:left; min-height:100px; border-left: 2px solid var(--primary); padding-left:10px;"></div>
        <h1 id="total-usd" style="color:var(--price-gold); margin:20px 0;">TOTAL: $0</h1>
        <button onclick="triggerHackerPay()" class="ui-btn" style="width:100%; background:var(--price-gold); color:black; height:60px; font-size:20px;">‚öîÔ∏è PAY NOW</button>
        <button onclick="showShop()" style="background:none; border:none; color:gray; margin-top:10px; cursor:pointer;">[ BACK TO TERMINAL ]</button>
    </div>
</div>

<div id="auth-overlay">
    <div class="payment-box glass-panel">
        <h1 style="color:var(--price-gold); letter-spacing: 5px;">GOLDEN_UPLINK</h1>
        <p id="payment-status-text" style="color:var(--secondary); font-size:10px;">>>> AUTHORIZING TRANSACTION...</p>
        <div id="paypal-button-container" style="margin-top:20px;"></div>
        <button onclick="document.getElementById('auth-overlay').style.display='none'" class="ui-btn" style="margin-top:20px; border-color:red; color:red; width:100%;">ABORT</button>
    </div>
</div>

<div id="info-page" style="display:none; padding:20px;">
    <div class="glass-panel" style="max-width:800px; margin:auto; padding:30px;">
        <img id="info-img" style="width:100%; border:1px solid #333;">
        <h1 id="info-title" style="color:var(--primary)"></h1>
        <p id="info-desc"></p>
        <div id="info-btns"></div>
        <button onclick="showShop()" class="ui-btn" style="margin-top:20px;">BACK</button>
    </div>
</div>

<div style="position:fixed; bottom:0; left:0; width:100%; height:40px; background:rgba(0,0,0,0.9); border-top:1px solid var(--primary); display:flex; align-items:center;">
    <div style="background:var(--primary); color:black; padding:0 15px; font-weight:bold; height:100%; display:flex; align-items:center;">SYSTEM_LIVE</div>
    <marquee id="feed-text" style="color:var(--secondary)">>>> BOOTING MASTER_v4.0... SCANNING FOR THREATS... ENCRYPTION: ACTIVE...</marquee>
</div>

<audio id="snd-hover" src="https://www.myinstants.com/media/sounds/button-19.mp3"></audio>
<audio id="snd-click" src="https://www.myinstants.com/media/sounds/sci-fi-click.mp3"></audio>
<audio id="snd-biometric" src="https://www.myinstants.com/media/sounds/power-up-sound-effect.mp3"></audio>
<audio id="hacker-music" loop><source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-15.mp3"></audio>

<script>
let products = [], cart = [], coupons = {}, isAdmin = false, discount = 0, musicStarted = false;
let mouse = { x: 0, y: 0 };

// [9] Sound Engine
function playSnd(id) { 
    const s = document.getElementById(id); 
    if(s) { s.currentTime = 0; s.play().catch(()=>{}); } 
}

// [4] Neural Hub Toggle
function toggleHub() { 
    const m = document.getElementById('hub-menu');
    m.style.display = (m.style.display === 'flex') ? 'none' : 'flex';
    playSnd('snd-click');
}

// [8] Support System
function toggleSupport() {
    const t = document.getElementById('support-terminal');
    t.style.display = (t.style.display === 'flex') ? 'none' : 'flex';
    playSnd('snd-click');
}

function sendSupport() {
    const inp = document.getElementById('sup-input');
    const box = document.getElementById('support-msgs');
    if(!inp.value) return;
    box.innerHTML += `<div style="color:white">> YOU: ${inp.value}</div>`;
    // Add logic here to send to Discord via Fetch if you have a webhook
    inp.value = "";
    setTimeout(() => { box.innerHTML += `<div style="color:var(--primary)">> SYSTEM: Message relayed to encrypted server.</div>`; }, 1000);
}

// [5] Dynamic Ticker
const events = [
    ">>> NEW INJECTION DETECTED FROM IP: 192.168.1.1",
    ">>> GLOBAL BAN WAVE BYPASSED BY R4 MODULE",
    ">>> TRANSACTION STATUS: OMEGA_LEVEL SECURE",
    ">>> [ALERT] KERNEL EXPLOIT UPDATED FOR IOS 17",
    ">>> USER_ID_442 PURCHASED: ELITE_BYPASS"
];
setInterval(() => {
    document.getElementById('feed-text').innerText = events[Math.floor(Math.random()*events.length)];
}, 10000);

// [2] Biometric Sequence
function triggerHackerPay() {
    if(cart.length === 0) return alert("INVENTORY EMPTY");
    playSnd('snd-biometric');
    document.getElementById('biometric-overlay').style.display = 'flex';
    
    setTimeout(() => {
        document.getElementById('biometric-overlay').style.display = 'none';
        document.getElementById('auth-overlay').style.display = 'flex';
        renderPaypal();
    }, 2500);
}

function renderPaypal() {
    document.getElementById('paypal-button-container').innerHTML = '';
    let t=0; cart.forEach(i=>t+=parseFloat(i.price));
    let final = (t - (t * (discount/100))).toFixed(2);
    
    paypal.Buttons({
        style: { shape: 'rect', color: 'gold', layout: 'vertical' },
        createOrder: (data, actions) => actions.order.create({ purchase_units: [{ amount: { value: final } }] }),
        onApprove: (data, actions) => actions.order.capture().then(det => {
            cart.forEach(item => { if(item.delivery) { const a=document.createElement('a'); a.href=item.delivery.data; a.download=item.delivery.name; a.click(); } });
            alert("TRANSACTION VERIFIED"); location.reload();
        })
    }).render('#paypal-button-container');
}

// [6] Neural Particle Background
const canvas = document.getElementById('global-canvas');
const ctx = canvas.getContext('2d');
let dots = [];

function initDots() {
    dots = [];
    for(let i=0; i<100; i++) dots.push({ x: Math.random()*canvas.width, y: Math.random()*canvas.height, vx: (Math.random()-0.5)*1, vy: (Math.random()-0.5)*1 });
}

function drawGrid() {
    ctx.clearRect(0,0,canvas.width, canvas.height);
    ctx.strokeStyle = "rgba(0, 212, 255, 0.1)";
    ctx.lineWidth = 1;
    dots.forEach((d, i) => {
        d.x += d.vx; d.y += d.vy;
        if(d.x<0 || d.x>canvas.width) d.vx *= -1;
        if(d.y<0 || d.y>canvas.height) d.vy *= -1;
        
        ctx.beginPath();
        ctx.arc(d.x, d.y, 2, 0, Math.PI*2);
        ctx.fillStyle = "rgba(0, 212, 255, 0.5)";
        ctx.fill();

        // Connect lines
        for(let j=i+1; j<dots.length; j++) {
            let d2 = dots[j];
            let dist = Math.hypot(d.x-d2.x, d.y-d2.y);
            if(dist < 100) {
                ctx.beginPath();
                ctx.moveTo(d.x, d.y);
                ctx.lineTo(d2.x, d2.y);
                ctx.stroke();
            }
        }
        // Connect to mouse
        if(Math.hypot(d.x-mouse.x, d.y-mouse.y) < 150) {
            ctx.strokeStyle = "rgba(0, 212, 255, 0.3)";
            ctx.beginPath(); ctx.moveTo(d.x, d.y); ctx.lineTo(mouse.x, mouse.y); ctx.stroke();
        }
    });
    requestAnimationFrame(drawGrid);
}

function updateMouse(e) { mouse.x = e.clientX; mouse.y = e.clientY; }

// --- ORIGINAL CORE LOGIC (UNTYUCHED) ---
function displayProducts() {
    db.ref('products').on('value', (snap) => {
        products = snap.val() || [];
        const android = document.getElementById("android-grid"), ios = document.getElementById("ios-grid");
        if(!android) return;
        android.innerHTML = ""; ios.innerHTML = "";
        products.forEach((p, i) => {
            if(!p) return;
            const div = document.createElement("div"); div.className = "product glass-panel";
            div.onmouseenter = () => playSnd('snd-hover');
            div.innerHTML = `
                <img src="${p.image || ''}" onclick="showInfo(${i})" style="width:100%; height:150px; object-fit:cover;">
                <h3 style="color:var(--primary)">${p.name}</h3>
                <div style="color:var(--price-gold)">$${p.price}</div>
                <button onclick="addToCart(${i})" class="ui-btn" style="width:100%; margin-top:10px;">ADD TO CART</button>
            `;
            p.category === "ios" ? ios.appendChild(div) : android.appendChild(div);
        });
    });
}

function addToCart(i) { playSnd('snd-click'); cart.push(products[i]); updateCartCount(); }
function updateCartCount() { document.getElementById('cart-count').innerText = cart.length; }
function showCheckout() { document.getElementById('shop-page').style.display='none'; document.getElementById('checkout-page').style.display='block'; renderCart(); }
function renderCart() {
    let l=document.getElementById('cart-list'), t=0; l.innerHTML = "";
    cart.forEach((item, index) => {
        l.innerHTML += `<div style="padding:10px; border-bottom:1px solid #222; display:flex; justify-content:space-between;">
            <span>${item.name} - $${item.price}</span>
            <button onclick="cart.splice(${index},1); renderCart(); updateCartCount();" style="color:red; background:none; border:none;">[X]</button>
        </div>`;
        t += parseFloat(item.price);
    });
    document.getElementById('total-usd').innerText = "TOTAL: $" + (t - (t * (discount/100))).toFixed(2);
}
function showShop() { document.getElementById('shop-page').style.display='block'; document.getElementById('checkout-page').style.display='none'; }

window.onload = () => {
    canvas.width = window.innerWidth; canvas.height = window.innerHeight;
    initDots(); drawGrid(); displayProducts();
    
    let lb = document.getElementById('load-bar'), p = 0;
    let logBox = document.getElementById('load-logs');
    const logs = ["> INJECTING_DLL...", "> BYPASSING_SANDBOX...", "> ENCRYPTING_SESSION...", "> ACCESS_GRANTED"];
    let logIdx = 0;
    let int = setInterval(() => { 
        p += 5; lb.style.width = p + "%"; 
        if(p%25==0) { logBox.innerHTML += `<div>${logs[logIdx]}</div>`; logIdx++; }
        if(p>=100) { clearInterval(int); document.getElementById('loader-overlay').style.display='none'; }
    }, 50);
};

function startAudio() { if(!musicStarted) { document.getElementById('hacker-music').play(); musicStarted = true; } }
</script>
</body>
</html>
